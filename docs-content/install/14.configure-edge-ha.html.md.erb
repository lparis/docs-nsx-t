---
title: Configure Edge Nodes for HA
owner: NSX-T
---

<strong><%= modified_date %></strong>

This section provides instructions for configuring failover mode for NSX Edge Nodes. If the T0 Router is not correctly cofigured for HA, failover to the standby Edge Node will not occur.

![NSX Edge High Availability](images/vsphere/nsxt-edge-ha.png)

Proper configuration requires two new uplinks on the T0 router: one attached to Edge TN1, and the other attached to Edge TN2. In addition, you need to create a VIP that is the IP address used for the T0 uplink defined when the T0 Router was created.

  <img src="images/nsxt/nsx-misc/edge-node-ha-01.png">

## Prerequisites

These instructions assume you have completed the following prerequisites:

- Part 1: Deploy NSX Manager          
- Part 2: Deploy NSX Controllers                                  
- Part 3: Create NSX Clusters 
- Part 4: Deploy NSX Edge Nodes
- Part 5: Register NSX Edge Nodes
- Part 6: Enable Repository Service for VIB on NSX Manager 
- Part 7: Create TEP IP Pool
- Part 8: Create Overlay TZ
- Part 9: Create VLAN TZ
- Part 10: Create Uplink Profile for Edge Nodes
- Part 11: Create Transport Edge Nodes
- Part 12: Create Edge Cluster
- Part 13: Create T0 Router

###<a id='create-uplink1'></a>Create Uplink1 for Edge-TN1

1. On the T0 router, create Uplink1 attached to Egde TN 1.

	IP Address/Mask: `10.40.206.10/25`
	URPF Mode: None (optional)
	Transport Node: `edge-TN1`
	Logical Switch: `uplink-LS1`

  <img src="images/nsxt/nsx-misc/edge-node-ha-02.png">

1. Click Save.

##<a id='create-uplink2'></a>Create Uplink2 for Edge-TN2

1. On the T0 router, create Uplink2 attached to Egde TN 2.

	IP Address/Mask: `10.40.206.9/25`
	URPF Mode: None (optional)
	Transport Node: `edge-TN2`
	Logical Switch: `uplink-LS1`

  <img src="images/nsxt/nsx-misc/edge-node-ha-03.png">

1. Click Save.

##<a id='create-ha-vip'></a>Create HA VIP

1. On the T0 router, create the HA VIP:

<table>
  <tr>
    <th>Setting</th>
    <th>HA VIP</th>
  </tr>
  <tr>
    <td>VIP address</td>
    <td>10.40.206.24/25 (for example)</td>
  </tr>
  <tr>
    <td>Uplinks ports</td>
    <td>uplink-1 and uplink-2</td>
  </tr>
</table>

  <img src="images/nsxt/nsx-misc/edge-node-ha-04.png">

  <img src="images/nsxt/nsx-misc/edge-node-ha-05.png">

The HA VIP becomes the official IP for the T0 router uplink. External router devices peering with the T0 router _must_ use this IP address.

<p class="note"><strong>Note</strong>: IP for uplink-1, IP for uplink-2 and IP for HA VIP MUST belong to same subnet.</p>

##<a id='create-ha-vip'></a>Create Static Route for HA

1. On the T0 router, create a static default route so that the next hop points to the HA VIP address.

	Network: `0.0.0.0/0`
	Next Hop: `10.40.206.125`
	Logical Router port: empty

1. Using vCenter, disconnect the last interface of each Edge Node VM (this interface can cause duplicate packets).

  <img src="images/nsxt/nsx-misc/edge-node-ha-06.png">

##<a id='create-ha-vip'></a>Verify Edge Node HA

1. Verify Edge Node HA. The T0 router should display both Edge TN: Edge TN1 active / Edge TN2 standby.

  <img src="images/nsxt/nsx-misc/edge-node-ha-07.png">

1. Run the following commands to verify HA channels:

<pre class="terminal">
nsx-edge-n&gt; get high-availability channels
nsx-edge-n&gt; get high-availability channels stats
nsx-edge-n&gt; get logical-router
nsx-edge-n&gt; get logical-router ROUTER-UUID high-availability status
</pre>